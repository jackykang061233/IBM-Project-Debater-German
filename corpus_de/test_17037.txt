In Computernetzen ist das Tunneling-Protokoll (L2TP) ein Tunnelungsprotokoll, das zur Unterstützung virtueller privater Netze (VPN) oder als Teil der Erbringung von Diensten durch ISP verwendet wird. Es verwendet Verschlüsselung (versteckt) nur für seine eigenen Kontrollnachrichten (mit einer fakultativen vorgefertigten geheimen Geheimhaltung) und stellt keine Verschlüsselung oder Vertraulichkeit von Inhalten selbst vor. Man bietet vielmehr einen Tunnel für die Schicht 2 (die verschlüsselt werden kann), und der Tunnel selbst kann über ein 3 Verschlüsselungsprotokoll wie IPsec übertragen werden. Geschichte, die 2000 als vorgeschlagener Standard RFC 2661 veröffentlicht wurde, hat L2TP seine Ursprung vor allem in zwei älteren Tunnelbauprotokollen für Punkt-zu-Punkt-Kommunikation: Cisco's Layer 2 Forwarding Protokoll (L2F) und Microsoft'sPoint-to-Point Tunneling Protokoll (PPTP). L2TPv3, eine neue Version dieses Protokolls, wurde 2005 als vorgeschlagener Standard RFC 3931 erschienen. L2TPv3 bietet zusätzliche Sicherheitsmerkmale, verbesserte Encapsulation und die Fähigkeit, andere Datenverbindungen als nur Punkt-to-Point-Protokoll (PPP) über ein IP-Netz (z.B. Beschreibung Das gesamte L2TP-Paket, einschließlich Payload und L2TP-Marke, wird im Rahmen eines Nutzerdaten-Protokolls (UDP) übermittelt. Aufgrund der Übertragung über das UDP (und nicht nur über das iPhone) ist es das "TCP-Schrottproblem" zu vermeiden. Es ist üblich, PPP-Sitzungen innerhalb eines L2TP-Tunnels durchzuführen. L2TP bietet selbst keine Vertraulichkeit oder eine starke Authentifizierung. IPsec wird häufig verwendet, um L2TP-Pakete durch Vertraulichkeit, Authentifizierung und Integrität zu sichern. Die Kombination dieser beiden Protokolle ist im Allgemeinen als L2TP/IPsec bekannt (siehe unten). Die beiden Endpunkte eines L2TP-Tunnels sind der L2TP-Zugang Conentrator (LAC) und der L2TP-Netzserver (LNS). LNS wartet auf neue Tunnel. Nach Einrichtung eines Tunnels ist der Netzverkehr zwischen den Peers bidirektional. Um für die Vernetzung von Nutzen zu sein, laufen dann über den L2TP-Tunnel höhere Protokolle. Um dies zu erleichtern, wird im Tunnel eine L2TP-Sitzung für jedes mehrstufige Protokoll wie PPP eingerichtet. Entweder können die LAC oder LNS Sitzungen einleiten. L2TP ist für jede Sitzung isoliert, so dass es möglich ist, mehrere virtuelle Netze in einem einzigen Tunnel einzurichten. Die innerhalb eines L2TP-Tunnels ausgetauschten Pakete werden entweder als Kontrollpakete oder Datenpakete eingestuft. L2TP bietet Zuverlässigkeitsmerkmale für die Kontrollpakete, aber keine Zuverlässigkeit für Datenpakete. Zuverlässigkeit muss, wenn gewünscht, von den in jeder Sitzung des L2TP-Tunnels befindlichen Nestern geliefert werden. L2TP ermöglicht die Schaffung eines virtuellen privaten Wahlnetzes (VPDN) zur Anbindung eines entlegenen Kunden an sein Unternehmensnetz durch Nutzung einer gemeinsamen Infrastruktur, die das Internet oder das Netz eines Diensteanbieters sein könnte. Tunnelmodelle Ein L2TP-Tunnel kann über eine gesamte PPP-Sitzung oder nur über ein Segment einer Zweiteilungssitzung erstrecken. Dies kann durch vier verschiedene Tunnelmodelle vertreten werden: freiwilliger Tunnel obligatorischer Tunnel — ein neuer Anruf obligatorischer Tunnel — Fernwahl L2TP Multihop-Anschluss L2TP Paketstruktur L2TP-Paket besteht aus: Felde: Flaggen und Versionskontrollflaggen mit Angabe von Daten/Kontrollpaket und Vorhandensein von Länge, Sequenz und Offset-Bereichen. Länge (fakultativ) Gesamtlänge der Botschaft in den Byten, nur wenn die Länge festgelegt ist. Tunnel ID legt den Kennzeichen für die Kontrollverbindung fest. Sitzung ID legt den Kennzeichen für eine Sitzung innerhalb eines Tunnels fest. Ns (fakultativ) Sequenznummer für diese Daten- oder Kontrollbotschaft, beginnend mit Null und Herabsetzung (Modulo 216) für jede gesendete Nachricht. Nur dann, wenn die Flagge gesetzt wird. Keine (fakultative) Sequenznummer für erwartete Botschaft zu erhalten. Keiner ist an die Ns der letzten intakten Botschaft sowie an eine (Modulo 216) gerichtet. Datennachrichten, Keine ist reserviert und, falls vorhanden (wie im S Bit angegeben), wird MUST nach Eingang ignoriert. Kompensationsgröße (fakultativ) Spezifiziert, wo die Ladedaten in der Vergangenheit der L2TP-Marke liegen. Wenn der Offset-Bereich vorhanden ist, endet die L2TP-Marke nach der letzten Auffüllung. Kann die Offset-Flagge gesetzt werden. Offset Pad (fakultativ) variable Länge, wie in der Ausgleichsgröße angegeben. Inhalt dieses Bereichs sind nicht definiert. Ladedaten variable Länge (maximale Ladegröße =Max Größe des UDP-Pakets – Größe der L2TP-Marke) Zum Zeitpunkt der Einrichtung der L2TP-Verbindung werden viele Kontrollpakete zwischen Server und Kunden ausgetauscht, um Tunnel und Tagungen für jede Richtung einzurichten. Ein Peer fordert den anderen Peer auf, einen bestimmten Tunnel und eine Sitzung durch diese Kontrollpakete zuzuweisen. Anschließend werden die Datenpakete mit dem komprimierten PPP-Rahmen als Beladung ausgetauscht. L2TP-Kontrollbotschaften, die zwischen LAC und LNS ausgetauscht werden, für Handkläge vor der Einrichtung eines Tunnels und der Tagung in der freiwilligen Tunnelungsmethode sind L2TP/IPsecBecause des im L2TP-Protokoll enthaltenen Mangels an Vertraulichkeit, wird oft zusammen mit IPsec durchgeführt. L2TP/IPsec wird bezeichnet und ist in IETF RFC 3193 standardisiert. Der Prozess der Einrichtung eines L2TP/IPsecSY ist wie folgt: Verhandlungen über IPsec Security Association (SA), in der Regel über den Internet-Schlüsselaustausch (IKE). Das wird über den UDP-Hafen 500 durchgeführt und verwendet in der Regel entweder ein gemeinsames Passwort (sogenannte „vorverkaufte Schlüssel“), öffentliche Schlüssel oder X.509 Zertifikate an beiden Enden, obwohl andere Schlüsselmethoden existieren. Einrichtung einer Mitteilung über die Sicherheitslast (ESP) im Verkehrsmodus. IP-Protokollnummer für ESP beträgt 50 (Kompare-Modul 6 und UDP 17). In diesem Punkt wurde ein sicherer Kanal eingerichtet, aber kein Tunnel läuft. Verhandlungen und Einrichtung des L2TP-Tunnels zwischen den SA- Endpunkten. Die tatsächliche Aushandlung von Parametern erfolgt über den Sicherheitskanal der SA im Rahmen der IPsec-Verschlüsselung. L2TP nutzt UDP Hafen 1701. L2TP-Pakete zwischen den Endpunkten werden von IPsec zusammengefasst. Da das L2TP-Paket selbst im IPsecpack und versteckt ist, ist die ursprüngliche Quelle und die Ziel-IP-Adresse im Paket verschlüsselt. Auch ist es nicht notwendig, den UDP-Hafen 1701 auf Firewalls zwischen den Endpunkten zu öffnen, da die internen Pakete nicht gehandelt werden, bis die IPsec-Daten entschlüsselt und abgezogen wurden, was nur an den Endpunkten stattfindet. L2TP/IPsec ist die Nutzung des Begriffstunnels und der sicheren Kanal. Der Begriff Tunnelmode bezieht sich auf einen Kanal, der unangetastete Pakete eines Netzes über ein anderes Netz transportiert. Im Falle von L2TP/PPP ist es möglich, L2TP/PPP-Pakete über IP zu transportieren. Ein sicherer Kanal bezieht sich auf eine Verbindung, in der die Vertraulichkeit aller Daten gewährleistet ist. L2TP/IPsec bietet erste IPsec einen sicheren Kanal, dann bietet L2TP einen Tunnel. IPsec stellt auch ein Tunnelprotokoll fest: das wird nicht verwendet, wenn ein L2TP-Tunnel verwendet wird. Windows-Durchführung Windows hat seit Windows 2000 eine einheimische Unterstützung (konfigurierbar in der Kontrollgruppe) für L2TP bereitgestellt. Windows Vista fügte 2 alternative Werkzeuge hinzu, ein MMC-Set-in namens "Windows Firewall with Advanced Security" (WFwAS) und das "netsh advwall"-System. Eine Begrenzung sowohl der WFwAS- als auch der Nettosh-Auflagen ist, dass Server von IP-Adresse angegeben werden müssen. Windows 10 fügte die Add-VpnConnection und Set-VpnConnectionIPsecConfiguration hinzu Kraft Shell-Aufgaben. Ein Registrierungsschlüssel muss auf dem Kunden und Server erstellt werden, wenn der Server hinter einem NAT-T-Gerät steht. [1] L2TP in den Netzen von ISPs L2TP wird häufig von ISPs genutzt, wenn der Internetdienst beispielsweise über ADSL oder Kabel wiederverkauft wird. Ab dem Endnutzer reisen die Pakete über ein Netz-Service-Anbieternetz auf einen Server namens Breitband-Zugang Server (BRAS), ein Protokollumwandler und einen kombinierten Router. Auf alten Netzen kann der Weg von Endgeräten des Endbenutzers in die BRAS über ein ATM-Netz liegen. Über ein IP-Netz läuft ein L2TP-Tunnel vom BRAS (als LAC) bis zu einem LNS, der an der Grenze des IP-Netzes des Zielortes steht. Beispiel für Wiederverkäufer, die L2TP verwenden. RFC-Referenzwerte RFC 2341 Cisco-Level Zwei Forwarding (Protocol) L2F (ein Vorgänger für L2TP)RFC 2637 Punkt-to-Point Tunneling Protokoll (PPTP) RFC 2661 Stufe Zwei Tunneling-Protokoll L2TP RFC 2809 Durchführung von L2TP Compulsory Tunneling über RADIUS RFC 2888Secure Remote Access mit L2 RFC 30-Level RFC70-Tunneling Protokoll (L2TP) Trennwand Grundinformation RFC 3193 Verbriefung von L2TP mit IPsec RFC 3301 Stufe 2 Tunneling-Protokoll (L2TP): ATM-Zugangsnetz RFC 3308 Stufe Zwei Tunneling-Protokoll (L2TP)Differentiated Services RFC 3355 Stufe Zwei Tunneling-Protokoll (L2TP)Over ATM Anpassung 5 (AAL5) RFC 3371 Stufe Zweiing-Management-Informationsbasis RFC 3437 Zwei Erweiterungsprotokolle für Link-Kontrollprotokolle RFC 3355 PPP-Netz (L) Verweise Externe Links Umsetzung Cisco: Cisco L2TP-Dokumente lesen auch Technologieinformationen von Cisco Open Source und Linux: xl2tpd, Linux RP-L2TP, OpenL2TP, l2tpds, l2tpd (inaktiv), Linux L2TP/IPsec Server, Desktop-link PPP da Panik, OpenBSD nppd 8, ACCEL-PPP -L2TP/PPE Server für Microsoft: gebaut mit Windows 2000 und höher als Microsoft-CIP/IT/CIP VPDN auf Cisco.com Andere IANA zugewiesene Nummern für L2TP L2TP Erweiterungsgruppe (l2tpext) - (wo künftige Normungsarbeiten koordiniert werden)Using-Lizenzen als L2TP/IPsec-Server L2TP/IPSec mit OpenBSD und npppd Vergleich von L2TP, RJP und OpenVPN