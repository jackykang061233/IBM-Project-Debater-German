Wi-Fi Protected Access (WPA),Wi-Fi Protected Access II (WPA2,) undWi-Fi Protected Access 3 (WPA3) sind die drei von der Wi-Fi Alliance entwickelten Sicherheits- und Sicherheitszertifizierungsprogramme, um drahtlose Computernetze zu sichern. Die Allianz definierte diese als Reaktion auf ernsthafte Schwächen, die Forscher im vorherigen System gefunden hatten, Wired Equivalent Privacy (WEP). WPA (manchmal TKIP-Standard genannt) wurde 2003 verfügbar. Die Wi-Fi-Allianz beabsichtigte es als eine Zwischenmaßnahme, um die Verfügbarkeit des sichereren und komplexen WPA2, die im Jahr 2004 zur Verfügung gestellt wurde, vorzubeugen und ist eine gemeinsame Kurzhand für den vollen IEEE 802.11i (oder IEEE 802.11i-2004) Standard. Im Januar 2018 gab Wi-Fi Alliance die Veröffentlichung von WPA3 mit mehreren Sicherheitsverbesserungen über WPA2 bekannt. Versionen WPA Die WLAN-Allianz beabsichtigte WPA als Zwischenmaßnahme, den Platz der WEP bis zur Verfügbarkeit des vollen IEEE 802.11i-Standards zu übernehmen. WPA konnte durch Firmware-Upgrades auf Wireless-Netzwerk-Schnittstellenkarten für WEP realisiert werden, die bis 1999 mit dem Versand begannen. Da die in den Wireless Access Points (APs) geforderten Änderungen jedoch umfangreicher waren als die auf den Netzwerkkarten benötigten, konnten die meisten APs vor 2003 nicht auf die Unterstützung von WPA aktualisiert werden. Das WPA-Protokoll implementiert das Temporal Key Integrity Protocol (TKIP). WEP verwendet einen 64-Bit- oder 128-Bit-Verschlüsselungsschlüssel, der manuell auf drahtlosen Access Points und Geräten eingegeben werden muss und sich nicht ändert. TKIP verwendet einen Per-Packet-Schlüssel, was bedeutet, dass er dynamisch einen neuen 128-Bit-Schlüssel für jedes Paket erzeugt und somit die Arten von Angriffen verhindert, die WEP beeinträchtigten. WPA enthält auch einen Message Integrity Check, der dazu ausgelegt ist, einen Angreifer daran zu hindern, Datenpakete zu ändern und zu ändern. Dies ersetzt die durch den WEP-Standard verwendete zyklische Redundanzprüfung (CRC). Der Hauptfehler der CRC war, dass sie keine hinreichend starke Datenintegritätsgarantie für die von ihr bearbeiteten Pakete lieferte. Um diese Probleme zu lösen, gab es bewährte Nachrichtenauthentifizierungscodes, die jedoch zu viel Rechenaufwand auf alten Netzwerkkarten erforderten. WPA verwendet einen Nachrichtenintegritäts-Check-Algorithmus namens TKIP, um die Integrität der Pakete zu überprüfen. TKIP ist viel stärker als ein CRC, aber nicht so stark wie der in WPA2 verwendete Algorithmus. Forscher haben seither einen Fehler in WPA entdeckt, der auf ältere Schwächen in WEP und die Einschränkungen der Nachrichtenintegrität Code Hash Funktion, namens Michael, um den Keystream von kurzen Paketen abrufen, um für Re-Injektion und Spoofing verwenden. WPA2 Bewertet im Jahr 2004, WPA2 ersetzt WPA. WPA2, die die Prüfung und Zertifizierung durch die Wi-Fi Alliance erfordert, implementiert die obligatorischen Elemente von IEEE 802.11i. Insbesondere umfasst es die obligatorische Unterstützung für CCMP, einen AES-basierten Verschlüsselungsmodus. Die Zertifizierung begann im September 2004. Vom 13. März 2006 bis zum 30. Juni 2020 war die WPA2-Zertifizierung für alle neuen Geräte erforderlich, um die Wi-Fi-Marke zu tragen. WPA3Im Januar 2018 kündigte die Wi-Fi Alliance WPA3 als Ersatz für die WPA2.Certification im Juni 2018 an. Der neue Standard verwendet im WPA3-Enterprise-Modus (AES-256 im GCM-Modus mit SHA-384 als HMAC) eine äquivalente kryptographische Stärke von 192-Bit und übernimmt weiterhin die Verwendung von CCMP-128 (AES-128 im CCM-Modus) als minimaler Verschlüsselungsalgorithmus im WPA3-Persönlichen Modus. Der WPA3-Standard ersetzt auch den Pre-shared Key (PSK)-Austausch mit Simultaneous Authentication of Equals (SAE)-Austausch, eine Methode, die ursprünglich mit IEEE 802.11s eingeführt wurde, was zu einem sichereren anfänglichen Schlüsselaustausch im persönlichen Modus und im Vorwärtsgeheimnis führt. Das WLAN Allianz behauptet auch, dass WPA3 Sicherheitsprobleme mit schwachen Passwörtern mildern und den Prozess der Einrichtung von Geräten ohne Display-Schnittstelle vereinfachen wird. Der Schutz von Verwaltungsrahmen gemäß der IEEE 802.11 wird ebenfalls durch die WPA3-Spezifikationen durchgesetzt. Die Hardware-Unterstützung WPA wurde speziell entwickelt, um mit drahtloser Hardware zu arbeiten, die vor der Einführung des WPA-Protokolls produziert wurde, was eine unzureichende Sicherheit durch WEP bietet. Einige dieser Geräte unterstützen WPA nur nach der Anwendung von Firmware-Upgrades, die für einige ältere Geräte nicht verfügbar sind. WLAN-Geräte, die seit 2006 zertifiziert sind, unterstützen sowohl die WPA- als auch die WPA2-Sicherheitsprotokolle. WPA3 ist seit 1. Juli 2020 erforderlich. Die neueren Versionen können nicht mit einigen älteren Netzwerkkarten funktionieren. WPA-Terminologie Unterschiedliche WPA-Versionen und Schutzmechanismen können anhand des Zielendbenutzers (nach der Methode der Authentifizierungsschlüsselverteilung) und des verwendeten Verschlüsselungsprotokolls unterschieden werden. Zielbenutzer (Authentifizierungsschlüsselverteilung)WPA-Personal Auch als WPA-PSK (Pre-shared key) Modus bezeichnet, ist diese für Heim- und kleine Büronetze konzipiert und benötigt keinen Authentifizierungsserver. Jedes drahtlose Netzwerkgerät verschlüsselt den Netzwerkverkehr, indem es seinen 128-Bit-Verschlüsselungsschlüssel aus einem 256-Bit-Gegenschlüssel ableitet. Dieser Schlüssel kann entweder als String von 64 hexadezimalen Ziffern oder als Passphrase von 8 bis 63 bedruckbaren ASCII Zeichen eingetragen werden. Wenn ASCII-Zeichen verwendet werden, wird der 256-Bit-Schlüssel durch Anlegen der PBKDF2-Schlüsselableitungsfunktion an die Passphrase mit der SSID als Salz und 4096 Iterationen von HMAC-SHA1 berechnet. WPA-Persönlicher Modus ist auf allen drei WPA-Versionen verfügbar. WPA-Enterprise Auch als WPA-802.1X-Modus bezeichnet, und manchmal nur WPA (im Gegensatz zu WPA-PSK) ist dies für Unternehmensnetzwerke konzipiert und erfordert einen RADIUS-Authentifizierungsserver. Dies erfordert ein komplizierteres Setup, bietet aber zusätzliche Sicherheit (z.B. Schutz gegen Wörterbuchangriffe auf kurze Passwörter). Zur Authentifizierung werden verschiedene Arten des Extensible Authentication Protocol (EAP) verwendet. WPA-Enterprise-Modus ist auf allen drei WPA-Versionen verfügbar. Wi-Fi Protected Setup (WPS) Dies ist eine alternative Authentifizierungs-Schlüsselverteilungsmethode zur Vereinfachung und Stärkung des Prozesses, die aber, wie weit implementiert, ein großes Sicherheitsloch über die WPS PIN-Recovery erstellt. Verschlüsselungsprotokoll TKIP (Temporal Key Integrity Protocol) Der RC4-Stream-Cipher wird mit einer 128-Bit-Per-Packet-Taste verwendet, was bedeutet, dass er dynamisch einen neuen Schlüssel für jedes Paket erzeugt. Dies wird von WPA verwendet. CCMP (CTR-Modus mit CBC-MAC-Protokoll) Das Protokoll, das von WPA2 verwendet wird, basiert auf dem Advanced Encryption Standard (AES) Cipher sowie einer starken Nachrichten-Authentizitäts- und Integritätsprüfung, ist im Schutz sowohl für die Privatsphäre als auch für die Integrität wesentlich stärker als das RC4-basierte TKIP, das von WPA verwendet wird. Unter informellen Namen sind AES und AES-CCMP". Gemäß der 802.11n Spezifikation muss dieses Verschlüsselungsprotokoll verwendet werden, um schnelle 802.11nhigh Bitrate-Systeme zu erreichen, jedoch nicht alle Implementierungen dies durchsetzen. Andernfalls wird die Datenrate 54 Mbit/s nicht überschreiten. EAP-Erweiterungen unter WPA und WPA2 Enterprise Ursprünglich wurde nur EAP-TLS (Extensible Authentication Protocol - Transport Layer Security) von der WLAN-Allianz zertifiziert. Im April 2010 kündigte die Wi-Fi Alliance die Aufnahme zusätzlicher EAP-Typen in ihre WPA- und WPA2-Enterprise-Zertifizierungsprogramme an. Dies sollte sicherstellen, dass WPA-Enterprise zertifizierte Produkte miteinander interoperieren können. Ab 2010 umfasst das Zertifizierungsprogramm folgende EAP-Typen: EAP-TLS (vorher getestet) EAP-TTLS/MSCHAPv2 (April 2005) PEAPv0/EAP-MSCHAPv2 (April 2005)PEAPv1/EAP-GTC (April 2005)PEAP-TLS EAP-SIM (April 2005)EAP-AKA (April 2009)EAP-FAST(April 2009)802.1X Clients und Server, die von bestimmten Unternehmen entwickelt wurden, können andere EAP-Typen unterstützen. Diese Zertifizierung ist ein Versuch, populäre EAP-Typen zu interoperieren; ihr Versagen, dies ab 2013 zu tun, ist eines der wichtigsten Probleme, die Rollout von 802.1X in heterogenen Netzwerken verhindern. Zu den kommerziellen 802.1X Servern gehören Microsoft Internet Authentication Service und Juniper Networks Steelbelted RADIUS sowie Aradial Radius Server. FreeRADIUS ist ein Open Source 802.1X Server. Sicherheitsprobleme Schwaches Passwort Vorgeteilte Schlüssel WPA und WPA2 bleiben anfällig für Passwort-Cracking-Angriffe, wenn Benutzer auf ein schwaches Passwort oder Passphrase vertrauen. WPA passphrase hashes werden aus dem SSID-Namen und seiner Länge gesät; Regenbogentabellen existieren für das Top 1000 Netzwerk SSIDs und eine Vielzahl von gemeinsamen Passwörtern, die nur einen schnellen Blick auf die Rißbildung WPA-PSK erfordern. Mit der Aircrack Suite können die Brute-Zahnungen von einfachen Passwörtern ausgehend von dem bei Assoziierung oder periodischer Re-Authentifizierung ausgetauschten Vierweg-Authentifizierungshandshake versucht werden. WPA3 ersetzt kryptographische Protokolle, die für die Offline-Analyse anfällig sind, durch Protokolle, die eine Interaktion mit der Infrastruktur für jedes erratene Passwort erfordern und angeblich zeitliche Grenzen auf die Anzahl der Erraten setzen. Designfehler in WPA3 ermöglichen Angreifer jedoch, brutale Angriffe zu starten (siehe Dragonblood-Angriff.) Mangel an Vorwärtsgeheimnis WPA und WPA2 bieten keine Vorwärtsgeheimnis, was bedeutet, dass, sobald eine schädliche Person den Vor-shared-Schlüssel entdeckt, sie möglicherweise alle Pakete entschlüsseln können, die mit dem in der Zukunft und sogar Vergangenheit übertragenen PSK verschlüsselt werden, die passiv und leise vom Angreifer gesammelt werden könnte. Dies bedeutet auch, dass ein Angreifer stumm andere Pakete erfassen und entschlüsseln kann, wenn ein WPA-geschützter Access Point an einer öffentlichen Stelle kostenlos zur Verfügung gestellt wird, weil sein Passwort an dieser Stelle normalerweise jedem geteilt wird. Mit anderen Worten, WPA schützt nur vor Angreifern, die keinen Zugriff auf das Passwort haben. Dadurch ist es sicherer, Transport Layer Security (TLS) oder ähnliches zu verwenden. Diese Frage wurde jedoch ausgehend von WPA3 behandelt. WPA-Paket Spoofing und Entschlüsselung Mathy Vanhoef und Frank Piessens verbesserte sich bei den WPA-TKIP-Angriffen von Erik Tews und Martin Beck deutlich. Sie zeigten, wie man eine beliebige Anzahl von Paketen injiziert, wobei jedes Paket maximal 112 Bytes Nutzlast enthält. Dies zeigte sich durch die Implementierung eines Portscanners, der mit WPA-TKIP gegen jeden Client ausgeführt werden kann. Zusätzlich zeigten sie, wie man beliebige Pakete entschlüsselt, die an einen Client gesendet werden. Sie erwähnten dies kann verwendet werden, um eine TCP-Verbindung zu entführen, so dass ein Angreifer böswillige JavaScript injizieren, wenn das Opfer eine Website besucht. Demgegenüber konnte der Beck-Tews-Angriff nur kurze Pakete mit meist bekannten Inhalten wie ARP-Nachrichten entschlüsseln und nur eine Injektion von 3 bis 7 Paketen von maximal 28 Bytes zulassen. Der Beck-Tews-Angriff erfordert auch die Qualität des Dienstes (wie in 802.11e definiert) zu aktivieren, während der Vanhoef-Piessens-Angriff nicht. Weder Angriff führt zur Wiederherstellung des gemeinsamen Sitzungsschlüssels zwischen Client und Access Point. Die Autoren sagen, mit einem kurzen Rekeying-Intervall kann einige Angriffe verhindern, aber nicht alle, und empfehlen dringend, von TKIP auf AES-basierte CCMP zu wechseln. Halvorsen und andere zeigen, wie man den Beck-Tews-Angriff modifiziert, um die Injektion von 3 bis 7 Paketen mit einer Größe von maximal 596 Bytes zu ermöglichen. Der Nachteil ist, dass ihr Angriff wesentlich mehr Zeit benötigt, um auszuführen: etwa 18 Minuten und 25 Sekunden. In anderen Arbeiten zeigten Vanhoef und Piessens, dass, wenn WPA verwendet wird, um Rundfunkpakete zu verschlüsseln, auch ihr ursprünglicher Angriff ausgeführt werden kann. Dies ist eine wichtige Erweiterung, da wesentlich mehr Netzwerke WPA verwenden, um Rundfunkpakete zu schützen, als Unicast-Pakete zu schützen. Die Ausführungszeit dieses Angriffs beträgt im Durchschnitt etwa 7 Minuten, verglichen mit den 14 Minuten des ursprünglichen Vanhoef-Piessens und Beck-Tews-Angriffs. Die Sicherheitslücken von TKIP sind signifikant, weil WPA-TKIP vor einer extrem sicheren Kombination gehalten worden war; in der Tat, WPA-TKIP ist noch eine Konfigurationsoption auf einer Vielzahl von drahtlosen Routing-Geräten von vielen Hardware-Anbietern zur Verfügung gestellt. Eine Umfrage im Jahr 2013 ergab, dass 71% noch die Nutzung von TKIP erlauben und 19% ausschließlich TKIP unterstützen. WPS PIN Erholung Ein schwerwiegenderer Sicherheitsfehler wurde im Dezember 2011 von Stefan Viehböck offenbart, der kabellose Router mit der Wi-Fi Protected Setup (WPS) Funktion beeinflusst, unabhängig davon, welche Verschlüsselungsmethode sie verwenden. Die letzten Modelle haben diese Funktion und aktivieren sie standardmäßig. Viele Verbraucher Wi-Fi-Gerätehersteller hatten Schritte unternommen, um das Potenzial der schwachen Passphrase-Auswahlen zu beseitigen, indem alternative Methoden der automatischen Generierung und Verteilung von starken Schlüsseln gefördert werden, wenn Benutzer einen neuen Wireless-Adapter oder -Appliance zu einem Netzwerk hinzufügen. Diese Methoden umfassen Drucktasten auf den Geräten oder Eingabe einer 8-stelligen PIN. Die WLAN-Allianz standardisierte diese Methoden als Wi-Fi Protected Setup; die PIN-Funktion, wie weit umgesetzt, führte jedoch einen großen neuen Sicherheitsfehler ein. Der Fehler ermöglicht es einem entfernten Angreifer, das WPS PIN und damit das WPA/WPA2-Passwort des Routers in wenigen Stunden wiederherzustellen. Benutzer wurden aufgefordert, die WPS-Funktion auszuschalten, obwohl dies auf einigen Router-Modellen nicht möglich ist. Auch wird die PIN auf einem Label auf den meisten Wi-Fi Routern mit WPS geschrieben und kann nicht geändert werden, wenn Kompromisse. WPA3 stellt eine neue Alternative für die Konfiguration von Geräten vor, die keine ausreichenden Benutzeroberflächenkapazitäten haben, indem nahe gelegene Geräte als ausreichendes UI für Netzwerkbereitstellungszwecke dienen können, wodurch die Notwendigkeit von WPS gemildert wird. MS-CHAPv2 und fehlender AAA-Server CN-Validierung Mehrere Schwächen wurden in MS-CHAPv2 gefunden, von denen einige stark die Komplexität von brutalen Angriffen reduzieren, wodurch sie mit modernen Hardware machbar. Im Jahr 2012 wurde die Komplexität des Bruchs von MS-CHAPv2 auf die eines einzigen DES-Schlüssels reduziert, die Arbeit von Moxie Marlinspike und Marsh Ray. Moxie sagte: "Enterprises, die auf die gegenseitigen Authentifizierungseigenschaften von MS-CHAPv2 für die Verbindung zu ihren WPA2 Radius-Servern angewiesen sind, sollten sofort beginnen, auf etwas anderes zu wandern." Tunneled EAP-Methoden mit TTLS oder PEAP, die den MSCHAPv2-Austausch verschlüsseln, sind weit verbreitet, um vor Ausnutzung dieser Sicherheitslücke zu schützen. Die vorherrschenden WPA2-Client-Implementierungen während der frühen 2000er Jahre waren jedoch anfällig für Fehlkonfigurationen durch Endbenutzer, oder in einigen Fällen (z.B. Android) fehlte es an einer nutzergerechten Möglichkeit, die Validierung des AAA-Serverzertifikats CNs richtig zu konfigurieren. Dies erweiterte die Relevanz der ursprünglichen Schwäche in MSCHAPv2 in MiTM-Angriffsszenarien. Unter strengeren WPA2-Compliance-Tests, die neben WPA3 angekündigt wurden, wird eine zertifizierte Client-Software benötigt, um bestimmte Verhaltensweisen rund um die AAA-Zertifizierung zu erfüllen. Hole196 Hole196 ist eine Schwachstelle im WPA2-Protokoll, das die gemeinsame Gruppe Temporal Key (GTK) missbraucht. Es kann verwendet werden, um Man-in-the-Middle- und Denial-of-Service-Angriffe durchzuführen. Sie geht jedoch davon aus, dass der Angreifer bereits gegen Access Point und damit im Besitz des GTK authentifiziert ist. Predictable Group Temporal Key (GTK) 2016 wurde gezeigt, dass die WPA- und WPA2-Standards einen unsicheren Expository Zufallszahlengenerator (RNG) enthalten. Forscher zeigten, dass ein Angreifer bei der Implementierung des vorgeschlagenen RNG den Gruppenschlüssel (GTK) vorhersagen kann, der vom Access Point (AP) zufällig generiert werden soll. Zusätzlich zeigten sie, dass der Besitz des GTK es dem Angreifer ermöglicht, jeglichen Verkehr in das Netzwerk einzudringen und dem Angreifer erlaubte, den über das drahtlose Netzwerk übertragenen unicast-Internetverkehr zu entschlüsseln. Sie demonstrierten ihren Angriff auf einen Asus RT-AC51U-Router, der die MediaTek-Außenfahrer nutzt, die den GTK selbst erzeugen, und zeigten, dass der GTK innerhalb von zwei Minuten oder weniger zurückgewonnen werden kann. In ähnlicher Weise zeigten sie die Tasten, die von Broadcom-Zugangs-Daemons auf VxWorks 5 und später in vier Minuten oder weniger erzeugt werden können, was beispielsweise bestimmte Versionen von Linksys WRT54G und bestimmte Apple AirPort Extreme-Modelle betrifft. Verkäufer können sich gegen diesen Angriff verteidigen, indem sie einen sicheren RNG verwenden. Dadurch ist Hostapd, der auf Linux-Kernels läuft, gegen diesen Angriff nicht verletzlich und Router, die typische OpenWrt- oder LEDE-Installationen ausführen, zeigen dieses Problem nicht. KRACK-Angriff Im Oktober 2017 wurden Details des KRACK (Key Reinstallation Attack) Angriffs auf WPA2 veröffentlicht. Der KRACK-Angriff wird geglaubt, alle Varianten von WPA und WPA2 zu beeinflussen; jedoch variieren die Sicherheitsaspekte zwischen Implementierungen, je nachdem, wie einzelne Entwickler einen schlecht spezifizierten Teil des Standards interpretierten. Software-Patches können die Sicherheitslücke lösen, sind aber nicht für alle Geräte verfügbar. Dragonblood-Angriff Im April 2019 wurden ernsthafte Designfehler in WPA3 gefunden, die es Angreifern ermöglichen, Abwärts-Angriffe und Side-Channel-Angriffe durchzuführen, wodurch die Passphrase brutal zwingt, sowie Denial-of-Service-Angriffe auf Wi-Fi-Basisstationen gestartet werden. Referenzen Externe Links Offizielle Standards Dokument: IEEE Std 802.11i-2004 (PDF). IEEE (Institut für Elektro- und Elektronikingenieure, Inc.).23 Juli 2004.ISBN 0-7381-4074-0.Wi-Fi bei Curlie Wi-Fi Alliance Interoperabilität Zertifikatsseite Schwäche in Passphrase Choice in WPA Interface, von Robert Moskowitz. Retrieved March 2, 2004.The Evolution of 802.11 Wireless Security, von Kevin Benton, 18. April 2010Archived 2016-03-02 auf der Wayback-Maschine