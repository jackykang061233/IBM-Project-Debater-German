Internet Protocol Version 4 (IPv4) ist die vierte Version des Internet Protocol (IP). Es ist eines der Kernprotokolle von Standard-basierten Internetbearbeitungsmethoden im Internet und anderen paketvermittelten Netzwerken. IPv4 war die erste Version für die Produktion auf SATNET im Jahre 1982 und auf dem ARPANET im Januar 1983. Es wird noch verwendet, um die meisten Internet-Verkehr heute, trotz der laufenden Bereitstellung eines Nachfolger-Protokolls, IPv6.IPv4 verwendet einen 32-Bit-Adressen-Raum, die 4,294,967,296 (232) einzigartige Adressen, aber große Blöcke sind für spezielle Netzwerk-Methoden reserviert. Geschichte Die IP-Schicht wurde ursprünglich im v3 des TCP für die Konstruktionsverbesserung getrennt und in der Version 4.IPv4 stabilisiert, wird in der IETF-Publikation RFC 791 (September 1981) beschrieben, die eine frühere Definition ersetzt (RFC 760, Januar 1980). Im März 1982 erklärte das US-Verteidigungsministerium TCP/IP als Standard für alle militärischen Computernetzwerke. Zweck Das Internetprotokoll ist das Protokoll, das die Internetverarbeitung auf der Internetschicht der Internet Protocol Suite definiert und ermöglicht. Im Wesentlichen bildet es das Internet. Es verwendet ein logisches Adressierungssystem und führt Routing durch, das die Weiterleitung von Paketen von einem Quell-Host an den nächsten Router ist, der dem Ziel-Host in einem anderen Netzwerk näher liegt. IPv4 ist ein verbindungsloses Protokoll und arbeitet an einem Best-Ausgang-Liefermodell, indem es die Lieferung nicht garantiert, noch gewährleistet es eine ordnungsgemäße Sequenzierung oder Vermeidung von Doppellieferung. Diese Aspekte, einschließlich Datenintegrität, werden von einem oberen Schichttransportprotokoll, wie dem Transmission Control Protocol (TCP) behandelt. IPv4 verwendet 32-Bit-Adressen, die den Adressraum auf 4294967296 (232) Adressen begrenzt. IPv4 behält sich spezielle Adressblöcke für private Netzwerke (~18 Millionen Adressen) und Multicast Adressen (~270 Millionen Adressen) vor. Adressdarstellungen IPv4-Adressen können in einer Notation dargestellt werden, die einen 32-Bit-Integerwert ausdrückt. Sie sind am häufigsten in dot-dezimaler Notation geschrieben, die aus vier Oktetten der Adresse besteht, die einzeln in Dezimalzahlen ausgedrückt und durch Perioden getrennt werden. Beispielsweise stellt die quad-dotierte IP-Adresse 192.0.2.235 die 32-Bit-Dezimalzahl 3221226219 dar, die im hexadezimalen Format 0xC00002EB beträgt. Dies kann auch im dotierten Hex-Format als 0xC0.0x00.0x02.0xEB oder mit Octabyte-Werten als 0300.0002.0353.CIDR-Notation kombiniert die Adresse mit ihrem Routing-Prefix in einem kompakten Format, in dem die Adresse von einem Slash-Zeichen (/) gefolgt wird und die Anzahl der führenden aufeinanderfolgenden 1 Bits im Routing-Prefix (Subnet-Mas). Andere Adressdarstellungen wurden häufig verwendet, als eine klassifizierte Vernetzung praktiziert wurde. Beispielsweise wird die Loopback-Adresse 127.0.0.1 häufig als 127.1 geschrieben, da sie zu einem Class-A-Netzwerk mit acht Bits für die Netzwerkmaske und 24 Bit für die Host-Nummer gehört. Wenn in der punktierten Notation weniger als vier Zahlen in der Adresse angegeben werden, wird der letzte Wert als eine ganze Zahl von so vielen Bytes behandelt, wie sie zum Ausfüllen der Adresse an vier Oktette erforderlich sind. So entspricht die Adresse 127.65530 127.0.255.250 Allocation Im ursprünglichen Design von IPv4 wurde eine IP-Adresse in zwei Teile aufgeteilt: die Netzwerkkennung war das bedeutendste Oktett der Adresse, und die Hostkennung war der Rest der Adresse. Letzteres wurde auch als Restfeld bezeichnet. Diese Struktur erlaubte maximal 256 Netzkennzeichen, die schnell als unzureichend empfunden wurden. Um diese Grenze zu überwinden, wurde 1981 das bedeutendste Adress-Oktett neu definiert, um Netzwerkklassen zu schaffen, in einem System, das später als klassifizierte Vernetzung bekannt wurde. Das überarbeitete System definiert fünf Klassen. Die Klassen A, B und C hatten verschiedene Bitlängen zur Netzwerkidentifizierung. Der Rest der Adresse wurde verwendet, um einen Host in einem Netzwerk zu identifizieren. Aufgrund der unterschiedlichen Größen von Feldern in verschiedenen Klassen hatte jede Netzwerkklasse eine andere Fähigkeit, Hosts anzusprechen. Neben den drei Klassen für die Adressierung von Hosts wurde Klasse D für Multicast-Adressen definiert und Klasse E für zukünftige Anwendungen reserviert. Mit der Veröffentlichung von RFC 950 begann 1985 die Aufteilung bestehender klassifizierter Netze in Teilnetze. Diese Division wurde mit der Einführung von variablen Subnetzmasken (VLSM) in RFC 1109 1987 flexibler gemacht. 1993, basierend auf dieser Arbeit, RFC 1517 eingeführt Classless Inter-Domain Routing (CIDR), die die Anzahl der Bits (aus den wichtigsten) wie zum Beispiel /24 ausdrückte, und das klassenbasierte Schema wurde klassifiziert, dagegen.CIDR wurde entwickelt, um ein Wiederaufteilen eines beliebigen Adressraums zu ermöglichen, so dass den Nutzern kleinere oder größere Adressblöcke zugeordnet werden können. Die von CIDR erstellte hierarchische Struktur wird von der Internet Assigned Numbers Authority (IANA) und den regionalen Internet-Registern (RIRs) verwaltet. Jeder RIR unterhält eine öffentlich durchsuchbare WHOIS-Datenbank, die Informationen über IP-Adressenzuweisungen liefert. Sonderadressen Die Internet Engineering Task Force (IETF) und IANA haben von der allgemeinen Nutzung verschiedene reservierte IP-Adressen für besondere Zwecke beschränkt. Insbesondere werden diese Adressen für den Multicast-Verkehr verwendet und bieten Adressierungsraum für uneingeschränkte Nutzungen in privaten Netzwerken. Privatnetze Von den in IPv4 definierten rund vier Milliarden Adressen sind etwa 18 Millionen Adressen in drei Bereichen für den Einsatz in privaten Netzwerken reserviert. Paketadressen in diesen Bereichen sind im öffentlichen Internet nicht routable; sie werden von allen öffentlichen Routern ignoriert. Daher können private Hosts nicht direkt mit öffentlichen Netzwerken kommunizieren, sondern benötigen dafür Netzwerkadressenübersetzung an einem Routing-Gateway. Da zwei private Netzwerke, z.B. zwei Zweigstellen, nicht direkt über das öffentliche Internet interoperieren können, müssen die beiden Netzwerke über ein virtuelles privates Netzwerk (VPN) oder einen IP-Tunnel über das Internet überbrückt werden, der bei der Übertragung über das öffentliche Netz Pakete, einschließlich ihrer die privaten Adressen enthaltenden Header, in einer Protokollschicht verkapselt. Zusätzlich können gekapselte Pakete zur Übertragung über öffentliche Netzwerke verschlüsselt werden, um die Daten zu sichern. Link-lokale Adressierung RFC 3927 definiert den speziellen Adressblock 169.254.0.0/16 für Link-Local-Adressen. Diese Adressen sind nur auf dem Link gültig (z.B. ein lokales Netzwerksegment oder Punkt-zu-Punkt-Verbindung) direkt mit einem Host verbunden, der diese nutzt. Diese Adressen sind nicht routable. Wie private Adressen können diese Adressen nicht die Quelle oder das Ziel von Paketen sein, die das Internet durchlaufen. Diese Adressen werden in erster Linie für die Adressautokonfiguration (Zeroconf) verwendet, wenn ein Host keine IP-Adresse von einem DHCP-Server oder anderen internen Konfigurationsmethoden erhalten kann. Als der Adressblock reserviert wurde, gab es keine Standards für die Adressautokonfiguration. Microsoft erstellte eine Implementierung namens Automatic Private IP Addressing (APIPA), die auf Millionen von Maschinen eingesetzt wurde und zu einem De-facto-Standard wurde. Viele Jahre später, im Mai 2005, definierte der IETF einen formalen Standard in RFC 3927 mit dem Titel Dynamic Configuration of IPv4 Link-Local Addresses. Loopback Das classA-Netzwerk 127.0.0.0 (klassenloses Netzwerk 127.0.0.0/8) ist für das Loopback reserviert. IP-Pakete, deren Quelladressen zu diesem Netzwerk gehören, sollten niemals außerhalb eines Hosts erscheinen. Pakete, die auf einer nicht-loopback-Schnittstelle mit einer Loopback-Quelle oder einer Zieladresse empfangen werden, müssen abgesetzt werden. Erste und letzte Subnetadressen Mit der ersten Adresse in einem Subnetz wird das Subnetz selbst identifiziert. In dieser Adresse sind alle Hostbits 0. Um Doppeldeutigkeit in der Darstellung zu vermeiden, ist diese Adresse reserviert. Die letzte Adresse hat alle Hostbits auf 1. Es wird als lokale Sendeadresse zum Senden von Nachrichten an alle Geräte im Subnetz gleichzeitig verwendet. Für Netzwerke der Größe /24 oder größer, endet die Sendeadresse immer in 255. Beispielsweise im Subnetz 192.168.5.0/24 (Subnetmaske 255.255.255.0) die Kennung 192.168.5.0 auf das gesamte Subnetz bezogen wird. Die Sendeadresse des Netzes beträgt 192.168.5.255 Dies bedeutet jedoch nicht, dass jede in 0 oder 255 endende Adresse nicht als Hostadresse verwendet werden kann. Beispielsweise beträgt im /16 Subnetz 192.168.0.0/255.255.0.0, das dem Adressbereich 192.168.0.0–192.168.255.255 entspricht, die Sendeadresse 192.168.255.255.255. Man kann die folgenden Adressen für Hosts verwenden, obwohl sie mit 255: 192.168.1.255, 192.168.2.255, etc. enden.Also, 192.168.0.0 ist die Netzwerkkennung und darf nicht einer Schnittstelle zugeordnet werden. Die Adressen 192.168.1.0, 192.168.2.0 usw. können trotz Ende mit 0 zugewiesen werden. In der Vergangenheit kam es zu Konflikten zwischen Netzwerkadressen und Sendeadressen, da einige Software nicht standardmäßige Rundfunkadressen mit Nullen anstelle von anderen verwendet. In Netzwerken kleiner als /24 enden Rundfunkadressen nicht unbedingt mit 255. Beispielsweise weist ein CIDR-Subnetz 203.0.113.16/28 die Sendeadresse 203.0.113.31 Als Sonderfall hat ein /31 Netzwerk Kapazität für nur zwei Hosts. Diese Netzwerke werden typischerweise für Punkt-zu-Punkt-Verbindungen verwendet. Für diese Netze gibt es keine Netzkennung oder Rundfunkadresse.Adressauflösung Hosts im Internet sind in der Regel durch Namen bekannt, z.B. www.example.com, nicht primär durch ihre IP-Adresse, die zur Routing- und Netzwerkschnittstellenidentifikation verwendet wird. Die Verwendung von Domain-Namen erfordert das Übersetzen, das aufgerufene Lösen, sie zu Adressen und umgekehrt. Dies ist analog, um eine Telefonnummer in einem Telefonbuch mit dem Namen des Empfängers zu suchen. Die Übersetzung zwischen Adressen und Domänennamen wird durch das Domain Name System (DNS) ein hierarchisches, verteiltes Namenssystem durchgeführt, das die Subdelegation von Namespaces an andere DNS-Server ermöglicht. Adressraumerschöpfung Seit den 1980er-Jahren zeigte sich, dass der Pool der verfügbaren IPv4-Adressen mit einem Satz verarmt wurde, der bei der ursprünglichen Gestaltung des Netzes nicht vorhersehbar war. Zu den wichtigsten Marktkräften, die eine beschleunigte Adreßverarmung beschleunigten, gehörten die schnell wachsende Zahl von Internetnutzern, die zunehmend mobile Rechengeräte wie Laptop-Computer, persönliche digitale Assistenten (PDAs) und Smartphones mit IP-Datendiensten eingesetzt haben. Darüber hinaus basierte der High-Speed-Internetzugang auf immer auf Geräten. Die Erschöpfungsbedrohung motivierte die Einführung einer Reihe von Heiltechnologien, wie zum Beispiel Classless Inter-Domain Routing (CIDR) Methoden bis Mitte der 1990er Jahre, die pervasive Nutzung der Netzwerkadressenübersetzung (NAT) in Netzzugangsanbietersystemen und strenge nutzungsbasierte Zuordnungspolitiken in den regionalen und lokalen Internet-Registern. Der primäre Adresspool des Internets wurde am 3. Februar 2011 erschöpft, als die letzten fünf Blöcke den fünf RIRs zugeordnet wurden. APNIC war der erste RIR, der am 15. April 2011 seinen regionalen Pool ausschöpft, mit Ausnahme einer kleinen Anzahl von Adressräumen, die für die Übergangstechnologien auf IPv6 reserviert sind, die im Rahmen einer eingeschränkten Politik zugeteilt werden soll. Die langfristige Lösung zur Bewältigung der Erschöpfung war die Spezifikation einer neuen Version des Internetprotokolls IPv6 von 1998. Es bietet einen enorm erhöhten Adressraum, ermöglicht aber auch eine verbesserte Routen-Aggregation über das Internet und bietet große Subnetwork-Zuweisungen von mindestens 264 Host-Adressen an Endbenutzer. IPv4 ist jedoch nicht direkt mit IPv6 interoperabel, so dass IPv4-nur Hosts nicht direkt mit IPv6-nur Hosts kommunizieren können. Mit der im Jahr 2004 gestarteten Phase-out des 6bone-Experimentalnetzwerks begann die permanente formale Einführung von IPv6 im Jahr 2006. Die Fertigstellung der IPv6-Bereitstellung wird voraussichtlich beträchtliche Zeit in Anspruch nehmen, so dass Zwischenübergangstechnologien notwendig sind, um Hosts mit beiden Versionen des Protokolls am Internet teilnehmen zu können. Packungsstruktur Ein IP-Paket besteht aus einem Header-Abschnitt und einem Daten-Abschnitt. Ein IP-Paket weist nach dem Datenabschnitt keine Datenüberprüfung oder einen anderen Footer auf. Typischerweise kapselt die Link-Schicht IP-Pakete in Frames mit einem CRC-Fußer, der die meisten Fehler erkennt, viele Transport-Schicht-Protokolle, die von IP getragen werden, haben auch eine eigene Fehlerkontrolle. Kopf Der IPv4-Paketkopf besteht aus 14 Feldern, von denen 13 benötigt werden. Das 14. Feld ist optional und passend benannt: Optionen. Die Felder im Header werden zuerst mit dem bedeutendsten Byte (großen Endian) verpackt und für das Diagramm und die Diskussion werden die wichtigsten Bits als erstes betrachtet (MSB 0 Bit Numerierung). Das bedeutendste Bit ist nummeriert 0, so dass das Versionsfeld in den vier wichtigsten Bits des ersten Bytes zum Beispiel tatsächlich gefunden wird. Version Das erste Headerfeld in einem IP-Paket ist das Vier-Bit-Versionsfeld. Für IPv4 ist dies immer gleich 4. Internet Header Länge (IHL)Der IPv4-Header ist aufgrund des optionalen 14. Feldes (Optionen) variabel. Das IHL-Feld enthält die Größe des IPv4-Headers, es hat 4 Bits, die die Anzahl der 32-Bit-Worte im Header angeben. Der Minimalwert für dieses Feld beträgt 5, was eine Länge von 5 × 32 Bits = 160 Bits = 20 Bytes angibt. Als 4-Bit-Feld beträgt der Maximalwert 15, so dass die maximale Größe des IPv4-Headers 15 × 32 Bits = 480 Bit = 60 Bytes beträgt. Differentiated Services Code Point (DSCP) Ursprünglich definiert als die Art des Dienstes (ToS,) gibt dieses Feld differenzierte Dienste (DiffServ) pro RFC 2474 an. Der Echtzeit-Datenstrom nutzt das DSCP-Feld. Ein Beispiel ist Voice over IP (VoIP), die für interaktive Sprachdienste verwendet wird. Explicit Congestion Notification (ECN)Dieses Feld ist in RFC 3168 definiert und ermöglicht eine End-to-End-Benachrichtigung über Netzwerk-Verstopfung, ohne Pakete zu fallen. ECN ist ein optionales Feature, wenn beide Endpunkte es unterstützen und effektiv, wenn auch durch das zugrunde liegende Netzwerk unterstützt.Gesamtlänge Dieses 16-Bit-Feld definiert die gesamte Paketgröße in Bytes, einschließlich Header und Daten. Die Mindestgröße beträgt 20 Bytes (Kopf ohne Daten) und das Maximum beträgt 65,535 Bytes. Alle Hosts sind erforderlich, um Datengramme der Größe bis zu 576 Bytes wieder zusammenbauen zu können, aber die meisten modernen Hosts behandeln viel größere Pakete. Links können weitere Einschränkungen der Paketgröße auferlegen, wobei Datengramme fragmentiert werden müssen. Die Fragmentierung in IPv4 erfolgt entweder im sendenden Host oder in Routern. Reassembly wird am empfangenden Host durchgeführt. Identifizierung Dieses Feld ist ein Identifikationsfeld und wird hauptsächlich zur eindeutigen Identifizierung der Gruppe von Fragmenten eines einzigen IP-Datengramms verwendet. Einige experimentelle Arbeiten haben vorgeschlagen, das ID-Feld für andere Zwecke zu verwenden, wie zum Hinzufügen von Paket-Tracing-Informationen, um Datengramme mit spoofed Source-Adressen zu verfolgen, aber RFC 6864 verbietet eine solche Verwendung. Flaggen Ein Drei-Bit-Feld folgt und wird verwendet, um Fragmente zu kontrollieren oder zu identifizieren. Sie sind (in Ordnung, von höchster bis kleinster Bedeutung:) Bit 0: Reserviert; muss null.bit 1: Nicht Fragment (DF) Bit 2: Mehr Fragments (MF) Wird das DF-Flag gesetzt und eine Fragmentierung erforderlich, um das Paket zu leiten, dann wird das Paket fallen gelassen. Dies kann verwendet werden, wenn Pakete an einen Host gesendet werden, der keine Ressourcen zur Remontage von Fragmenten hat. Es kann auch für die Pfad-MTU-Erkennung verwendet werden, entweder automatisch von der Host-IP-Software, oder manuell mit diagnostischen Tools wie Ping oder Traceroute. Für unfragmentierte Pakete wird die MF-Flagge gelöscht. Für fragmentierte Pakete haben alle Fragmente mit Ausnahme der letzten die MF-Flagge gesetzt. Das letzte Fragment hat ein nicht-zero Fragment Offset-Feld, das es von einem unfragmentierten Paket unterscheidet. Fragment Offset Dieses Feld gibt den Offset eines bestimmten Fragments gegenüber dem Beginn des ursprünglichen unfragmentierten IP-Datengramms in Einheiten von acht Byte-Blöcken an. Das erste Fragment hat einen Offset von Null. Das 13-Bit-Feld erlaubt einen maximalen Versatz von (213 – 1) × 8 = 65,528 Bytes, der mit der Headerlänge inklusive (65,528 + 20 = 65,548 Bytes) die Fragmentierung von Paketen unterstützt, die die maximale IP-Länge von 65,535 Bytes überschreiten. Zeit zum Leben (TTL)Eine Acht-Bit-Zeit, um Feld zu leben, begrenzt die Lebensdauer eines Datagramms, um Netzausfall im Falle einer Routing-Schleife zu verhindern. Es wird in Sekunden angegeben, aber Zeitintervalle weniger als 1 Sekunde sind auf 1 abgerundet. In der Praxis wird das Feld als Hopfenzählung verwendet – wenn das Datengramm an einem Router ankommt, dekriert der Router das TTL-Feld um eins. Wenn das TTL-Feld auf Null trifft, verworfen der Router das Paket und sendet typischerweise eine ICMP-Zeit überschritten Nachricht an den Absender. Die Programm-Trackroute sendet Nachrichten mit angepassten TTL-Werten und verwendet diese ICMP-Zeit überschritten Nachrichten, um die Router zu identifizieren, die von Paketen von der Quelle zum Ziel verfolgt werden. Protokoll Dieses Feld definiert das im Datenteil des IP-Datengramms verwendete Protokoll. IANA unterhält eine Liste von IP-Protokollnummern, wie von RFC 790. Prüfsumme Das 16-Bit IPv4 Header Prüfsummenfeld wird zur Fehlerkontrolle des Headers verwendet. Wenn ein Paket an einem Router ankommt, berechnet der Router die Prüfsumme des Headers und vergleicht es mit dem Prüfsummenfeld. Wenn die Werte nicht übereinstimmen, verworfen der Router das Paket. Fehler im Datenfeld müssen durch das gekapselte Protokoll behandelt werden. Sowohl die UDP als auch die TCP verfügen über separate Prüfsummen, die sich auf ihre Daten beziehen. Wenn ein Paket an einem Router ankommt, verringert der Router das TTL-Feld im Header. Folglich muss der Router eine neue Header-Checkum berechnen. Anschrift Dieses Feld ist die IPv4-Adresse des Absenders des Pakets. Beachten Sie, dass diese Adresse durch ein Übersetzungsgerät der Netzwerkadresse im Transit geändert werden kann. Anschrift Dieses Feld ist die IPv4-Adresse des Empfängers des Pakets. Wie bei der Quelladresse kann dies durch eine Netzwerkadressenübersetzungseinrichtung im Transit geändert werden. Optionen Das Auswahlfeld wird nicht oft verwendet. Beachten Sie, dass der Wert im IHL-Feld genug zusätzliche 32-Bit-Worte enthalten muss, um alle Optionen zu halten (plus jede Polsterung, die erforderlich ist, um sicherzustellen, dass der Header eine ganze Zahl von 32-Bit-Worte enthält). Die Liste der Optionen kann mit einer EOL (End of Options List, 0x00) Option beendet werden; dies ist nur erforderlich, wenn das Ende der Optionen nicht mit dem Ende des Headers zusammenfallen würde. Die möglichen Optionen, die in den Header gesetzt werden können, sind wie folgt: Anmerkung Ist die Kopflänge größer als 5 (d.h. von 6 bis 15) bedeutet dies, dass das Optionenfeld vorhanden ist und berücksichtigt werden muss.Hinweis: Copied, Optionsklasse und Optionsnummer werden manchmal als ein einziges Acht-Bit-Feld, den Optionstyp, bezeichnet. Pakete mit einigen Optionen können von einigen Routern als gefährlich betrachtet und blockiert werden. Die folgende Tabelle zeigt die definierten Optionen für IPv4. Streng genommen ist die Spalte mit "Optionsnummer" eigentlich der "Optionswert", der aus den oben definierten Copied-, Optionsklasse- und Optionsnummer-Bits abgeleitet wird. Da die meisten Menschen heute jedoch auf dieses kombinierte Bit-Set als "Optionsnummer" verweisen, zeigt diese Tabelle die häufige Verwendung. Die Tabelle zeigt sowohl die Dezimal- als auch die hexadezimalen Optionsnummern. Daten Die Paket-Payload ist nicht in der Prüfsumme enthalten. Der Inhalt wird anhand des Wertes des Protokoll-Header-Feldes interpretiert. Einige der gemeinsamen Payload-Protokolle sind: Siehe Liste der IP-Protokollnummern für eine vollständige Liste. Fragmentierung und Remontage Das Internet-Protokoll ermöglicht den Verkehr zwischen Netzwerken. Das Design beherbergt Netzwerke unterschiedlicher physikalischer Natur, es ist unabhängig von der zugrunde liegenden Übertragungstechnik in der Linkschicht. Netzwerke mit unterschiedlicher Hardware variieren in der Regel nicht nur in der Übertragungsgeschwindigkeit, sondern auch in der maximalen Übertragungseinheit (MTU). Wenn ein Netzwerk Datengramme an ein Netzwerk mit einer kleineren MTU übertragen will, kann es seine Datengramme fragmentieren. In IPv4 wurde diese Funktion auf der Internetebene platziert und wird in IPv4-Routern ausgeführt, was somit keine Implementierung höherer Schichten für die Funktion des Routings von IP-Paketen erfordert. Im Gegensatz dazu erlaubt IPv6, die nächste Generation des Internet-Protokolls, den Routern keine Fragmentierung durchzuführen; Hosts müssen den Pfad MTU bestimmen, bevor Datengramme gesendet werden. Fragmentierung Wenn ein Router ein Paket empfängt, prüft er die Zieladresse und bestimmt die abgehende Schnittstelle zu verwenden und die MTU der Schnittstelle. Ist die Paketgröße größer als die MTU, und das Do not Fragment (DF)-Bit im Paketkopf auf 0 gesetzt, so kann der Router das Paket fragmentieren. Der Router teilt das Paket in Fragmente. Die maximale Größe jedes Fragments ist die MTU abzüglich der IP-Headergröße (20 Bytes Minimum; maximal 60 Bytes). Der Router bringt jedes Fragment in sein eigenes Paket, jedes Fragmentpaket mit folgenden Änderungen: Das Gesamtlängenfeld ist die Fragmentgröße. Je mehr Fragmente (MF)-Flag für alle Fragmente außer dem letzten, der auf 0 gesetzt ist, gesetzt wird. Das Fragment-Offset-Feld wird basierend auf dem Offset des Fragments in der ursprünglichen Daten-Payload eingestellt. Dies wird in Einheiten von 8-Byte-Blöcken gemessen. Das Header-Checkum-Feld wird recomputiert. Für eine MTU von 1.500 Bytes und eine Kopfgröße von 20 Bytes wären die Fragmentversätze beispielsweise Vielfache von 1 , 500 - 20 8 = 185 {\displaystyle {\frac 1.500-20}{8}=185 .Diese Vielfachen sind 0, 185, 370, 555, 740 etc. Es ist möglich, dass ein Paket an einem Router fragmentiert wird und dass die Fragmente an einem anderen Router weiter fragmentiert werden. Beispielsweise wird ein Paket von 4,520 Bytes, einschließlich der 20 Bytes des IP-Headers (ohne Optionen) auf einer Verbindung mit einer MTU von 2.500 Bytes auf zwei Pakete zerlegt: Die Gesamtdatengröße wird erhalten: 2.480 Bytes + 2.020 Bytes = 4.500 Bytes. Die Offsets sind 0 {\displaystyle 0} und 0 + 2 , 480 8 = 310 {\displaystyle {\frac 0+2,480}{8}=310 .An einer Verbindung mit einer MTU von 1.500 Bytes ergibt jedes Fragment zwei Fragmente: Auch hier wird die Datengröße erhalten: 1.480 + 1.000 = 2.480 und 1.480 + 540 = 2.020. Auch in diesem Fall bleibt das More Fragments-Bit 1 für alle Fragmente, die mit 1 in ihnen kamen und für das letzte Fragment, das ankommt, funktioniert wie üblich, das ist das MF-Bit nur im letzten auf 0 gesetzt. Und natürlich hat das Identifikationsfeld in allen wieder zersplitterten Fragmenten weiterhin den gleichen Wert. Auf diese Weise weiß der Empfänger, dass er zunächst alle von demselben Paket gestartet hat, auch wenn Fragmente nachfragt werden. Die letzte Offset- und letzte Datengröße wird verwendet, um die Gesamtdatengröße zu berechnen: 495 × 8 + 540 = 3 , 960 + 540 = 4 , 500 {\displaystyle 495\times 8+540=3,960+540=4,500} .Wiedereinbau Ein Empfänger weiß, dass ein Paket ein Fragment ist, wenn mindestens eine der folgenden Bedingungen wahr ist: Die Flagge "mehr Fragmente" wird gesetzt, was für alle Fragmente außer dem letzten gilt. Das Feld "Fragment Offset" ist Nonzero, das gilt für alle Fragmente außer dem ersten. Der Empfänger identifiziert übereinstimmende Fragmente mit der fremden und lokalen Adresse, der Protokoll-ID und dem Identifikationsfeld. Der Empfänger reassembliert die Daten aus Fragmenten mit derselben ID sowohl mit dem Fragment-Offset als auch mit der Fragment-Flag. Wenn der Empfänger das letzte Fragment erhält, welches die auf 0 gesetzte "mehr Fragmente"-Flag aufweist, kann er die Größe der ursprünglichen Daten-Payload berechnen, indem er den Offset des letzten Fragments um acht multipliziert und die Datengröße des letzten Fragments addiert. Im angegebenen Beispiel betrug diese Berechnung 495*8 + 540 = 4500 Bytes. Wenn der Empfänger alle Fragmente aufweist, können sie in der richtigen Reihenfolge nach den Offsets wieder zusammengesetzt werden, um das ursprüngliche Datengramm zu bilden. Assistive Protokolle IP-Adressen werden nicht dauerhaft an Hardware-Identifikationen gebunden und in der Tat kann eine Netzwerkschnittstelle mehrere IP-Adressen in modernen Betriebssystemen haben. Hosts und Router benötigen zusätzliche Mechanismen, um die Beziehung zwischen Geräteschnittstellen und IP-Adressen zu identifizieren, um ein IP-Paket auf einem Link ordnungsgemäß an den Zielhost zu liefern. Das Address Resolution Protocol (ARP) führt diese IP-Adresse-zu-Hardware-Adresse-Übersetzung für IPv4 durch.(Eine Hardware-Adresse wird auch als MAC-Adresse bezeichnet.) Außerdem ist die umgekehrte Korrelation oft notwendig. Wenn beispielsweise ein IP-Host gestartet oder mit einem Netzwerk verbunden ist, muss er seine IP-Adresse bestimmen, es sei denn, eine Adresse wird von einem Administrator vorkonfiguriert. Protokolle für solche inversen Korrelationen gibt es in der Internet Protocol Suite. Derzeit verwendete Methoden sind Dynamic Host Configuration Protocol (DHCP,) Bootstrap Protocol (BOOTP) und selten umgekehrt ARP. Siehe auch Geschichte der Internet-Liste der zugewiesenen /8 IPv4-Adressenblöcke Liste der IP-Protokollnummern Anmerkungen Referenzen Externe Links Internet Zugeteilte Nummern Authority (IANA) IP, Internet Protocol — IP Header Breakdown, einschließlich spezifische Optionen RFC 3344 — IPv4 Mobility IPv6 vs. Carrier-grade NAT/squeezing mehr aus IPv4 RIPE-Bericht über den Adressverbrauch ab Oktober 2003 Offizielle aktuelle IPv-Adressen