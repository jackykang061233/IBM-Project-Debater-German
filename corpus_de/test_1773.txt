Das Media Transfer Protocol (MTP) ist eine Erweiterung des Kommunikationsprotokolls (PTP), mit dem Mediendateien automatisch auf und von tragbaren Geräten übertragen werden können. Während PTP für das Herunterladen von Fotos von digitalen Kameras konzipiert wurde, ermöglicht Media Transfer Protocol die Übertragung von Musikdateien auf digitale Audio-Player und Mediendateien auf tragbaren Medien-Player sowie persönliche Informationen über persönliche digitale Assistenten. MTP ist ein wesentlicher Bestandteil des WMDRM10-PD, einem digitalen Rechtemanagement (DRM)-Service für die Windows Media Plattform. 2011 wurde es die Standardmethode, um Dateien von / zu Android zu übertragen. MTP ist Teil des "Windows Media"-Rahmens und damit eng mit Windows Media Player verbunden. Versionen des Microsoft Windows Betriebssystems von Windows XP SP2 unterstützen MTP. Windows XP benötigt Windows Media Player 10 oder höher; später Windows-Versionen haben eingebaute Unterstützung. Microsoft hat auch ein MTP Porting Kit für ältere Versionen von Windows zurück zu Windows 98 zur Verfügung gestellt. Das USB Implementers Forum Gerät Arbeitsgruppe standardisiert MTP als vollwertiger Universal Serial Bus (USB) Geräteklasse im Mai 2008. Seitdem ist MTP eine offizielle Erweiterung zu PTP und teilt den gleichen Klassencode. Überblick Der Hauptzweck dieses Protokolls ist es, nur die Übertragung von Mediendateien und zugehörigen Metadaten zu und von tragbaren Geräten, einer Übertragungsfunktion, in oder out zu einem Zeitpunkt zu ermöglichen. Es unterstützt keine Operationen wie Öffnen, Bearbeiten und Modifizieren. Ein Workaround ist es, das Hosting-System für diese Operationen zu kopieren und dann wieder zu kopieren. Ein batteriebetriebenes Mobilgerät kann über MTP seinen Batterieladestand melden. Das Protokoll wurde ursprünglich für den Einsatz über USB implementiert, aber für den Einsatz über TCP/IP und Bluetooth erweitert. Windows Vista unterstützt MTP über TCP/IP. Windows 7 und Windows Vista mit dem Platform Update für Windows Vista unterstützen auch MTP über Bluetooth. Der mit einem MTP-Gerät verbundene Host wird als MTP-Initiator bezeichnet, während das Gerät selbst ein MTP-Responder ist. Ein Hauptgrund für die Verwendung von MTP anstatt beispielsweise der USB-Massenspeicher-Geräteklasse (MSC) ist, dass diese auf der Granularität eines Massenspeicher-Geräteblocks (in der Praxis meist ein FAT-Block) anstatt auf der logischen Dateiebene arbeitet. Mit anderen Worten, die USB-Massenspeicherklasse ist entworfen, um einen Host-Computer undifferenzierten Zugriff auf Massenspeicher, wie Kompakt-Flash, anstatt auf ein Dateisystem zu geben, das sicher mit dem Zielgerät geteilt werden könnte (außer für bestimmte Dateien, die der Host ändern/zugriffen sein könnte). In der Praxis, also, wenn ein USB-Host-Computer eine MSC-Partition montiert hat, übernimmt er die absolute Kontrolle des Speichers, die dann nicht sicher durch das Gerät ohne Gefahr von Datenverfälschung geändert werden kann, bis der Host-Computer die Verbindung abgetrennt hat. Darüber hinaus besteht die Gefahr, dass der Host-Computer das Dateisystem beschädigt, an ein nicht vom USB-Gerät unterstütztes Dateisystem reformiert oder anderweitig so verändert, dass das USB-Gerät es nicht vollständig verstehen kann. MTP und PTP übertreffen dieses Problem gezielt, indem die Einheit der verwalteten Speicherung eine lokale Datei anstatt eine ganze (möglicherweise sehr große) Einheit der Massenspeicher auf der Blockebene. Auf diese Weise funktioniert MTP wie ein Transaktionsdateisystem - entweder wird die gesamte Datei geschrieben/ gelesen oder nichts. Die Speichermedien werden nicht von fehlgeschlagenen Transfers betroffen. Wenn das Gerät eine Datenbank/Index des Inhalts der Festplatte aufrechterhält, speichert MTP die Kosten des erneuten Scannens der gesamten Festplatte jedes Mal, wenn der Inhalt geändert wird. Darüber hinaus ermöglicht das MTP MTP Initiators die Identifizierung der spezifischen Fähigkeiten von Geräten in Bezug auf Dateiformate und Funktionalität. Insbesondere, MTP Initiatoren können Passwörter und andere Informationen bereitstellen müssen, um Dateien zu entsperren oder andernfalls ein digitales Rechtemanagement zu ermöglichen. Nichts Spezifisches dieser Art ist im Kernstandard, aber die Features sind über Herstellererweiterungen verfügbar. MTPZ, die Zune Extension to MTP verweigert den Zugriff auf Dateien, bis die Authentifizierung bearbeitet wurde, was nur mit Windows Media Player 10 oder höher möglich ist. Der Vergleich mit den Vorteilen von USB-Massenspeicher MTP ist mit "(+)" gekennzeichnet, während Nachteile mit "(-)" gekennzeichnet sind. Dateiorientierte statt blockorientiertes Protokoll Durch die Nichtbelichtung des Dateisystems und des Metadatenindex ist die Integrität dieser in voller Kontrolle des Gerätes. (+) Kein Risiko von Dateisystem-Korruption, wenn das Gerät während des Schreibens unplugging. Dateiübertragungen sind atomar, und keine explizite Dateisystem-Unmounting ("Sichere Entfernung") ist vom Benutzer erforderlich. Das Gerät kann auf sein eigenes Dateisystem zugreifen, während angeschlossen: (+) Re-Indexing nach dem Entstopfen kann vermieden werden. Auch durch die Aufnahme von Metadaten mit dem transfer+.() Ein separates Dateisystem für die Host-Exposition ist unnötig. Dies vermeidet die Unflexibilität, eine Festformat-Partition für dieses Dateisystem+ aufzugeben.() Der Host muss das Dateisystem des Gerätes nicht unterstützen. Umgekehrt ist der Gerätehersteller frei, ein Dateisystem (in der Regel ein Linux-Dateisystem, das nicht von Windows unterstützt wird) zu wählen, außer der weithin unterstützten FAT-Familie von filesystems-.() Dateisystem-Recovery- und Undeletion-Tools auf dem Computer können nicht verwendet werden, weil MTP keinen Zugriff auf Blockebene bietet.() Viele MTP-angebundene Geräte, insbesondere ältere, setzen keine Dateizeitstempel über das Protokoll aus, wodurch sie verloren gehen, wenn Dateien kopiert/bewegt werden, um oder von einem Computer. Dateien wie JPEG-Fotos mit eingebetteten Exif-Daten haben noch Zeitstempel intern (und Dienstprogramme existieren, um die Dateizeitstempel basierend auf diesen wiederherzustellen), aber diese Workaround ist nicht für andere Arten von Dateien ohne solche internen Metadaten verfügbar. Performance (-) MTP-Betriebe sind nicht multiplexbar – jeder laufende Betrieb muss entweder abgeschlossen oder abgebrochen werden, bevor ein anderer Betrieb beginnen kann. Im Gegensatz zum USB-Massenspeicher, bei dem das Host-Betriebssystem frei ist, um Multiplex-Block-Transfers zu Multiplexen, und logische Operationen sind ein auftauchendes Phänomen, die Operationen unterstützt von MTP sind grobkörniger, wie die Übertragung von gesamten Dateien. Weder das Protokoll ist selbst parallel oder asynchron (außer der UAS-Erweiterung des USB-Massenspeichers, die mehrere Befehlsqueues addiert-.() Begrenzte Unterstützung bei der Übertragung von Dateien, wie Blöcken oder Byte-Bereichen (siehe § Direkte Modifikation und Teilübertragungsmerkmale-.() Begrenzte Unterstützung für die direkte Änderung von Dateien (siehe § Direkte Änderung und Teilübertragungsfunktionen). Um eine Datei oder deren Metadaten zu modifizieren, muss die gesamte Datei möglicherweise aus dem Gerät kopiert und wieder hochgeladen werden, was eine lange Zeit für eine große Datei oder ein Verzeichnis benötigt und das Gerät für andere Vorgänge in der Zwischenzeit blockiert. Googles MTP-Implementierung in Android enthält Erweiterungen, um diese Einschränkung zu bewältigen; jedoch müssen diese Erweiterungen durch das Host-Betriebssystem unterstützt werden-.() Das Laden längerer Dateilisten (tausende von Artikeln) und die Vorbereitung auf die Übertragung von Dateien könnte länger dauern als die Dateiübertragung selbst. Transparenz zu MTP-unaware Software (-) Windows ordnet Laufwerksbuchstaben oder UNC-Pfaden nicht an MTP-Geräte zu, weil es sie nicht als virtuelle Dateisysteme natives aussetzt. Ohne Laufwerksbuchstaben oder UNC-Pfade kann MTP-unaware-Software auf Verzeichnisse oder Dateien auf diesen Geräten nicht zugreifen. Der Benutzer muss auf eine MTP-Aware-Anwendung umschalten, oder auch mit einer MTP-Aware-Anwendung wie Windows Explorer arbeiten, um die Datei zu einem Dateisystem zu kopieren oder zu verschieben, auf das die Anwendung zugreifen kann. Eine besondere Sorge ist, dass Antivirus-Software auf dem Host-Computer möglicherweise nicht bewusst sein MTP-Geräte, so dass sie möglicherweise weniger sicher als Massenspeichergeräte (obwohl Dateien auf MTP-Geräten kopiert oder bewegt werden, um den Host vor der Verwendung, MTP-unaware Antivirus-Software hat eine Chance, sie zu scannen). Antivirus-Scannen kann auch unpraktisch sein, weil die regelmäßige Verwendung des Geräts blockiert. Treiber kennen einen festen Satz unterstützter Geräte (-) Trotz der Identifikation durch die PTP/MTP USB-Geräteklasse, libmtp-Dokumentation gibt an, dass die Hersteller- und Produkt-ID-Kombination eine funktionelle Rolle bei der Identifizierung eines MTP-Geräts spielt, auch von Windows-Treibern. Libmtp enthält umfangreiche Listen von Anbietern und Produkt-ID-Nummern von Geräten, die es unterstützt, zusammen mit Workarounds für Bugs. Diese nicht-generische Methode behindert die Kompatibilität der MTP-Treiber mit neuen Geräten. Die Spezifikation kennt einen festen Satz definierter Dateiformate Die MTP-Spezifikation umfasst eine Aufzählung von Dateiformaten, genannt Objektformat. Die Verwendung dieser Aufzählung erfolgt in der Kommunikation unterstützter Dateiformate und Formate übertragener Dateien. Abgesehen von einigen unkategorisierten Formaten am Anfang, wird die Liste der Formate in Kategorien von Bild-, Audio-, Video- und Dokumentformaten gruppiert, mit jeder Kategorie mit einem Undefinierten Format gefolgt von bestimmten Formaten. Es gibt auch ein super-generisches "Undefiniertes Objekt" Format. Jolla zitiert Mangel an WebM-Unterstützung in MTP als einen Grund, das Videoformat in ihrem mobilen Betriebssystem Sailfish OS nicht zu unterstützen. Es ist unklar, ob die Einschränkung in den Werkzeugen oder den Spezifikationen liegt, außer dass WebM nicht durch die MTP 1.1-Spezifikation definiert ist. Direkte Modifizierung und Teilübertragung Diese Funktionen können als effizientere Alternativen für Ganzfile-Transfers und Re-Uploads genutzt werden: Aus der MTP 1.1 Spezifikation: Android Erweiterungen Laut go-mtpfs: MTP-Unterstützung Windows Adaption in Windows MTP wird in Windows XP unterstützt, wenn Windows Media Player 10 oder spätere Versionen installiert sind. Windows Vista und später haben MTP-Unterstützung eingebaut. Für ältere Versionen von Windows, speziell Windows 2000, Windows 98 und Windows Me, Microsoft hat das MTP Porting Kit., das einen MTP-Gerät Treiber enthält veröffentlicht. Einige Hersteller, wie Creative Technology, bieten auch ältere MTP-Treiber für einige ihrer Spieler; diese bestehen in der Regel aus MTP Porting Kit-Dateien mit einer angepassten INF-Datei, die ihre spezifischen Spieler beschreibt. Unterstützung durch Software Windows gibt Laufwerksbuchstaben oder UNC-Pfadnamen nicht an Geräte, die über MTP angeschlossen sind; stattdessen erscheinen sie nur als benannte Geräte in MTP-Aware-Anwendungen wie Windows Explorer. Im Vergleich zu Geräten, die USB-Massenspeicher implementieren, können solche Geräte nicht programmatisch durch Skripte oder normale Windows-Programme aufgerufen werden, die von Laufwerksbuchstaben oder UNC-Pfaden abhängen. Stattdessen müssen Dateien mit Windows Explorer oder Anwendungen mit speziell geschriebenen MTP-Unterstützung manipuliert werden. Unter Windows unterstützen MTP-kompatible Geräte eine Funktion namens Auto Sync, die es Benutzern erlaubt, Windows Media Player automatisch alle kopierten oder neu erworbenen Inhalte auf Geräte zu übertragen, wenn sie verbunden sind - vorausgesetzt, dass Inhalte mit Windows Media Player kompatibel sind. Auto Sync ist anpassbar, so dass der Spieler nur Inhalte übertragen wird, die bestimmte Kriterien erfüllen (z.B. vier Sterne oder höher bewertet). Änderungen an Dateieigenschaften (z.B. Benutzerbewertung und Dateiwiedergabezählungen) auf einem Gerät können beim Wiederanschließen des Gerätes wieder auf den Computer ausgebreitet werden. Kopien von Dateien, die über MTP aufgerufen werden, können auf dem Host-Computer auch nach dem Neustart bleiben, wo sie für das Benutzerkonto zugänglich sind, auf das sie zugegriffen wurde, sowie alle anderen Benutzerkonten, die in der Lage sind, die Dateien des Benutzerkontos, einschließlich aller administrativen Benutzer, zu lesen. Die Sensorplattform von Windows 7 unterstützt Sensoren, die in MTP-kompatible Geräte eingebaut sind. Verhalten der Datei Bei der Implementierung von MTP, die von Windows Explorer verwendet wird, werden Dateien aus einer Auswahl, die aus dem Speicher eines mobilen Geräts bewegt wird, vielleicht mit dem Ziel, Platz freizugeben, nicht einzeln aus der Quelle nach jeder Datei gelöscht, sondern die gesamte Auswahl wird sofort aus der Quelle nur nach Beendigung der Übertragung gelöscht. Dadurch wird die Datei zeitlos abgebrochen, ob manuell oder unerwartet, keinen Platz auf dem Quellgerät freigegeben. Unixartige Systeme Als libmtp steht eine kostenlose und Open-Source-Implementierung des Media Transfer Protocol zur Verfügung. Diese Bibliothek enthält Produkt- und Geräte-IDs aus vielen Quellen und wird häufig in anderen Software für MTP-Unterstützung verwendet. Grafische GNOME-Anwendungen wie GNOME-Dateien (früher Nautilus) und Archive Manager (früher File-Roller genannt) verwenden GIO-basierte GVfs, um Dateien auf MTP-Geräte zuzugreifen. Die Proper MTP-Unterstützung wurde in Version 1.15.2 (2013-01-15) von Philip Langdale zu GVfs hinzugefügt. Frühe Patches für GVfs, um die direkten I/O-Erweiterungen von Google zu ermöglichen, sind verfügbar. Die KDE Das Projekt entwickelt den MTP KIO Slave mit einem ähnlichen Integrationsgrad wie GVfs. Nicht mit GNOME oder KDE verwandt ist der *NIX grafische MTP-fähige Medienplayer, gMTP. Virtuelles Dateisystem Mehrere Tools bieten ein FUSE-basiertes Dateisystem zur Montage von MTP-Geräten innerhalb der Hierarchie des Unix-Dateisystems, sodass es für jedes Programm, das auf Dateien und Verzeichnissen arbeitet, zugänglich ist. Beispiele sind mtpfs, jMTPFS, go-mtpfs und simple-mtpfs. macOS macOS unterstützt MTP (durch die Anwendung "Digitale Bilder") aber keine (Drittanbieter-)Treiber, um MTP-Geräte als Laufwerke zu montieren. Auch mehrere Drittanbieter-Datei-Transfer-Anwendungen sind für Mac OS X v10.5 und später verfügbar: Android File Transfer ist ein einfacher MTP-Client. Android File Transfer Für Linux (und Mac OS X,!) Open Source, License GPL Version 3, Graphical UI, Command Line Tool, FUSE Wrapper - Montage Ihres Geräts, XNJB bietet auch Synchronisierung von iTunes Playlists. SyncMate Expert behauptet, neben anderen Synchronisationsaufgaben auch MTP zu unterstützen. Der Support kann nicht in der kostenlosen Version getestet werden. Befehlshaber eines PRO Pack - Dateimanager, die MTP-Geräte auf Mac montieren und deren Inhalte verwalten können. Weitere Betriebssysteme Spätere Versionen mehrerer Betriebssysteme, darunter AmigaOS, Android, AROS, MorphOS und Symbian OS unterstützen MTP, manchmal mit zusätzlichen Treibern oder Software. Ein Nachteil von MTP-Geräten auf Android im Vergleich zu USB-Massenspeicher ist, dass zwar Dateizeitstempel erhalten werden, wenn Dateien vom Android-Gerät auf den eigenen Computer kopiert werden, beim Kopieren in die andere Richtung, die Datei-Änderung Zeitstempel ersetzt durch die Zeit, die Kopie gemacht wurde. Andere Hersteller Unternehmen, darunter Creative Technology, Intel, iriver und Samsung Electronics, die Geräte auf Basis der Microsoft-Spezifikation "Portable Media Center" herstellen, haben weithin MTP angenommen. Auf der Consumer Electronics Show 2004 wurden Support-Geräte vorgestellt. Nach einer anfänglichen Periode unsicherer Reaktionen nahmen mehrere große Mediaplayer-Hersteller wie Creative Technology und Iridver das MTP-Protokoll anstelle ihrer eigenen Protokolle an. Viele Geräte und Audio-Software-Anwendungen unterstützen MTP. Alternativen USB-Masse-Speicher Netzwerk-angebundene Speicher (NAS) Siehe auch Windows Media IEEE 1394 (firewire) Referenzen Externe Links MTP 1.1 Spezifikation Artikel über Canons Annahme auf der Wayback Machine (archiviert am 20. November 2008) MTP Was, Warum, Wie.(Android-Funktion)ArchLinux Wiki: Media Transfer Protocol